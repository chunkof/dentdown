<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>run</title>
<link rel="stylesheet" type="text/css" href="styles.css">
<script src="https://code.jquery.com/jquery-2.1.3.min.js"></script>
<script src="../lib/markdown.min.js"></script>
<script src="../dentdown.js"></script>
<script>
var dst_mode     = "html";
var dentdown     = new Dentdown();
// onLoad
function onLoad()
{
  // first run
  var src = $("#initial_src").val();
  $("#src_text").val(src);
  run();

  // bind to auto run
  var need_run = false;
  $('#src_text').keyup(function(e) {
    autoRun();
  });
}
// auto run
function autoRun()
{
  var check = $("#auto_run").prop('checked');
  if (!check){
    return;
  }
  run();
}
// run
function run()
{
  var src = $("#src_text").val();
  switch (dst_mode)
  {
    case "markdown":
        var dst =dentdown.toMarkdown(src);
        $("#dst_text").val(dst);
        activateDstText();
      break;
    case "html":
        var dst =dentdown.toHTML(src);
        $("#dst_text").val(dst);
        activateDstText();
      break;
    case "preview":
        var dst =dentdown.toHTML(src);
        $("#dst_html").html(dst);
        $("#dst_text").val(dst);
        activateDstPreview();
      break;
  }
}
// dst mode
function activateDstText()
{
  $("#dst_text").show();
  $("#dst_html").hide();
}
function activateDstPreview()
{
  $("#dst_text").hide();
  $("#dst_html").show();
}
function changeDstMode(value)
{
  dst_mode = value;
  run();
}
</script>
</head>
<body onLoad="onLoad()">
  <h1>Run "Dentdown"</h1>

  <!-- src -->
  <div id="src_div">
    <strong>Dentdown</strong><br>
    indent
    <select name="indent">
      <option value="tab">tab</option>
      <option value="2spaces">2spaces</option>
      <option value="4spaces">4spaces</option>
    </select>&nbsp;&nbsp;
    <input type="checkbox" id="auto_run" onClick="autoRun()" value="1" checked="checked">Auto Run&nbsp;
    <input type='button' value='Run->' onClick="run()">
    <textarea id="src_text"></textarea>
  </div>
  <!-- dst -->
  <div id="dst_div">
    <strong>Output</strong><br>
    <input type="radio" name="dst_mode" onClick="changeDstMode(value)" value="markdown">Markdown&nbsp;
    <input type="radio" name="dst_mode" onClick="changeDstMode(value)" value="html" checked="checked">HTML&nbsp;
    <input type="radio" name="dst_mode" onClick="changeDstMode(value)" value="preview">Preview&nbsp;
    
    <textarea id="dst_text" class="dst_result" readonly style="display:none" onClick="this.setSelectionRange(0, this.value.length)"></textarea>
    <div      id="dst_html" class="dst_result"></div>
  </div>

  <!-- data -->
  <textarea id="initial_src" style="display:none">
#AAA
  #aaa
    aaa
    aaa
#BBB
  bbb
  bbb
  </textarea>
</body>
</html>


